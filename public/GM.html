
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link href="GM.css " rel="stylesheet" type="text/css" /> 
    <link rel = "icon" href="data:,">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

    <h2 align = "left" id="name"></h2>

    <script>
        //run right away
        $.ajax({
            type:"get",
            url:"/userlist",
            success:function(data){
                if(data.status==-1){
                    var user="";
                    user+=data.user;
                    $("#name").html(user);
                }
            },
            error:function(){
                alert("Internet Error");
            }
        });    

    </script>>

    <title>GM</title>
  </head>
  <body>



  <h1>Game Manager</h1>
  <div id="GGM">
      <h2>Manage players</h2>





      <div action="/search" method="post" >
        <input type="text" id="search_cri" name="search_cri" placeholder="enter ID">
        <input type="submit" value="Search" id="gsearch" name="gsearch">
      </div>
    
      <table>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Age</th>
          </tr>
          <tr>
            <th id ="user">read</th>
            <th id = "pass">read</th>
            <th id = "name ">read</th>
          </tr>
      </table>
      <br></br>
      <h2>Delete player by ID</h2>
      <form action="/remove" method="post" >
        <input type="text" id="Gdelete" name="Gdelete" placeholder="enter ID">
        <input type="submit" value="Delete" id="delete">
      </form>
    </div>
    <div id="gpublish">
      <h2>Public Message Board</h2>
      <form action="/gmmessage" method="post">
        <label for="gmessage" ></label>
        <input type="text" id="gmessage" placeholder="Message Box" name="gmessage"/><br>
        <input type="submit" value="Publish" id="publish">
      </form>
        <input type="button" value="Logout" id="glogout">

    </div>

    <script>
        //wait til button clicked
        $("#glogout").click(function(){
            $.ajax({
                type:"get",
                url:"/logout",
                success:function(data){
                    if(data.status==-1){
                        location.href="https://stark-spire-21434.herokuapp.com/login.html";
                    }
                },
                error:function(){
                    alert("logout error!");
                }
            });
        }); 

        $("#gsearch").click(function(){
            var search_cri=$("#search_cri").val();
            var user1,pass1,name1;
            $.ajax({
                type:"post",
                url:"/search",
                data:{search_cri:search_cri},
                success:function(data){
                    var obj=JSON.parse(data.list[0]);
                    //$("#user").html=user1;
                    document.getElementById("user").innerHTML=obj;
                    $("#pass").html=obj.password;
                    $("#name").html=obj.name;

                    if(data.status==0){
                        alert("search success!");
                    }

                    else{
                        alert("search fail");
                    }
                },
                error:function(){
                    alert("search error!");
                }
            })
        });
    </script>






  </body>
</html>